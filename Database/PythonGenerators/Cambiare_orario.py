luoghi = [(0,115, "Campo Sportivo"),
(1,95, "Spazio Cultura"),
(2,4220, "Anfiteatro"),
(3,450, "Palazzetto Polifunzionale"),
(4,90, "Palasport"),
(5,3150, "Arena Concerti"),
(6,60, "Teatro all'Aperto"),
(7,120, "Palasport"),
(8,335, "Campo Sportivo"),
(9,44150, "Sala Consiliare"),
(10,325, "Cinema Moderno"),
(11,540, "Arena Comunale"),
(12,210, "Palazzo della Cultura"),
(13,115, "Palazzetto dello Sport"),
(14,130, "Sala Conferenze"),
(15, 10, 'Ufficio Erasmus'),
(16, 9, 'Ufficio Segreteria Studenti'),
(17, 9, 'Ufficio Protocollo'),
(18, 1278, 'Polo Didattico Lettere'),
(19, 837, 'Polo Didattico Biotecnologie'),
(20, 9, 'Ufficio Didattico'),
(21, 475, 'Polo Didattico Scienze'),
(22, 9, 'Ufficio Supporto Docenti'),
(23, 108, 'Aula Magna'),
(24, 10, 'Ufficio Erasmus'),
(25, 220, 'Parco della Didattica'),
(26, 185, 'Giardino Botanico'),
(27, 6, 'Ufficio Ricerca e Sviluppo'),
(28, 67, 'Aula Informatica 2'),
(29, 8, 'Ufficio Servizi Informatici'),
(30, 73, 'Aula Multimediale'),
(31, 99, 'Aula Laboratorio Fisica'),
(32, 99, 'Aula Didattica 202'),
(33, 102, 'Aula Studio C'),
(34, 6, 'Ufficio Servizi Informatici'),
(35, 852, 'Polo Didattico Fisica'),
(36, 4, 'Ufficio Orientamento'),
(37, 101, 'Aula Seminari'),
(38, 85, 'Aula Studio B'),
(39, 3, 'Ufficio Placement'),
(40, 10, 'Ufficio Placement'),
(41, 355, 'Polo Didattico Ingegneria'),
(42, 210, 'Giardino della Pace'),
(43, 8, 'Ufficio Supporto Docenti'),
(44, 61, 'Aula Didattica 202'),
(45, 102, 'Aula Didattica 102'),
(46, 93, 'Aula Laboratorio Matematica'),
(47, 4, 'Ufficio Erasmus'),
(48, 80, 'Aula Laboratorio Matematica'),
(49, 68, 'Aula Informatica 3'),
(50, 6, 'Ufficio Qualità'),
(51, 87, 'Aula Informatica 1'),
(52, 100, 'Aula Progetti'),
(53, 7, 'Ufficio Segreteria Studenti'),
(54, 5, 'Ufficio Risorse Umane'),
(55, 109, 'Aula Progetti'),
(56, 135, 'Giardino degli Studenti'),
(57, 140, 'Giardino della Conoscenza'),
(58, 59, 'Aula Studio C'),
(59, 211, 'Polo Didattico Informatica'),
(60, 96, 'Aula Informatica 2'),
(61, 59, 'Aula Conferenze'),
(62, 87, 'Aula Seminari'),
(63, 83, 'Aula Studio B'),
(64, 47, 'Aula Progetti'),
(65, 3, 'Ufficio Comunicazione'),
(66, 95, 'Aula Didattica 102'),
(67, 105, 'Aula Informatica 1'),
(68, 44, 'Aula Informatica Avanzata'),
(69, 9, 'Ufficio Logistica'),
(70, 211, 'Giardino delle Scienze'),
(71, 42, 'Aula Laboratorio Chimica'),
(72, 89, 'Aula Studio C'),
(73, 102, 'Giardino dei Saperi'),
(74, 43, 'Aula Studio B'),
(75, 238, 'Giardino della Ricerca'),
(76, 55, 'Aula Informatica 3'),
(77, 9, 'Ufficio Didattico'),
(78, 4, 'Ufficio Relazioni Internazionali'),
(79, 102, 'Aula Studio A'),
(80, 7, 'Ufficio Segreteria Studenti'),
(81, 83, 'Aula Progetti'),
(82, 6, 'Ufficio Segreteria Studenti'),
(83, 1499, 'Polo Didattico Fisica'),
(84, 250, 'Giardino delle Scienze'),
(85, 103, 'Aula Laboratorio Biologia'),
(86, 515, 'Polo Didattico Biotecnologie'),
(87, 6, 'Ufficio Qualità'),
(88, 47, 'Aula Seminari'),
(89, 109, 'Aula Laboratorio Chimica'),
(90, 10, 'Ufficio Segreteria Studenti'),
(91, 56, 'Aula Laboratorio Biologia'),
(92, 577, 'Polo Didattico Economia'),
(93, 719, 'Polo Didattico Medicina'),
(94, 8, 'Ufficio Protocollo'),
(95, 9, 'Ufficio Didattico'),
(96, 4, 'Ufficio Orientamento'),
(97, 9, 'Ufficio Risorse Umane'),
(98, 3, 'Ufficio Pianificazione'),
(99, 8, 'Ufficio Didattico'),
(100, 1139, 'Polo Didattico Comunicazione'),
(101, 112, 'Aula Didattica 201'),
(102, 138, 'Giardino della Pace'),
(103, 3, 'Ufficio Tecnico'),
(104, 1052, 'Polo Didattico Matematica'),
(105, 3, 'Ufficio Segreteria Studenti'),
(106, 10, 'Ufficio Placement'),
(107, 3, 'Ufficio Logistica'),
(108, 7, 'Ufficio Logistica'),
(109, 466, 'Polo Didattico Biotecnologie'),
(110, 7, 'Ufficio Servizi Informatici'),
(111, 1412, 'Polo Didattico Biotecnologie'),
(112, 62, 'Aula Progetti'),
(113, 5, 'Ufficio Logistica'),
(114, 8, 'Ufficio Servizi Informatici'),
(115, 42, 'Aula Studio A'),
(116, 6, 'Ufficio Ricerca e Sviluppo'),
(117, 283, 'Giardino della Ricerca'),
(118, 51, 'Aula Laboratorio Fisica'),
(119, 108, 'Aula Informatica Avanzata'),
(120, 6, 'Ufficio Qualità'),
(121, 82, 'Aula Studio C'),
(122, 3, 'Ufficio Affari Generali'),
(123, 8, 'Ufficio Segreteria Studenti'),
(124, 84, 'Aula Studio C'),
(125, 7, 'Ufficio Tecnico'),
(126, 45, 'Aula Informatica Avanzata'),
(127, 5, 'Ufficio Qualità'),
(128, 5, 'Ufficio Placement'),
(129, 4, 'Ufficio Tirocini'),
(130, 53, 'Aula Seminari'),
(131, 91, 'Aula Didattica 101'),
(132, 10, 'Ufficio Tirocini'),
(133, 91, 'Aula Studio B'),
(134, 7, 'Ufficio Relazioni Internazionali'),
(135, 62, 'Aula Laboratorio Chimica'),
(136, 5, 'Ufficio Amministrativo'),
(137, 1162, 'Polo Didattico Comunicazione'),
(138, 53, 'Aula Laboratorio Chimica'),
(139, 75, 'Aula Seminari'),
(140, 70, 'Aula Didattica 201'),
(141, 298, 'Giardino della Cultura'),
(142, 1105, 'Polo Didattico Matematica'),
(143, 81, 'Aula Studio A'),
(144, 8, 'Ufficio Servizi Informatici'),
(145, 110, 'Aula Multimediale'),
(146, 287, 'Parco della Didattica'),
(147, 102, 'Aula Informatica 3'),
(148, 59, 'Aula Conferenze'),
(149, 104, 'Aula Progetti'),
(150, 8, 'Ufficio Qualità'),
(151, 117, 'Aula Didattica 201'),
(152, 9, 'Ufficio Tirocini'),
(153, 104, 'Giardino delle Idee'),
(154, 101, 'Aula Studio B'),
(155, 138, 'Giardino della Ricerca'),
(156, 8, 'Ufficio Orientamento'),
(157, 99, 'Aula Seminari'),
(158, 3, 'Ufficio Qualità'),
(159, 134, 'Giardino dei Saperi'),
(160, 5, 'Ufficio Didattico'),
(161, 99, 'Aula Multimediale'),
(162, 9, 'Ufficio Tecnico'),
(163, 78, 'Aula Studio B'),
(164, 945, 'Polo Didattico Matematica'),
(165, 110, 'Aula Laboratorio Matematica'),
(166, 356, 'Polo Didattico Architettura'),
(167, 7, 'Ufficio Relazioni Internazionali'),
(168, 1365, 'Polo Didattico Fisica'),
(169, 5, 'Ufficio Didattico'),
(170, 115, 'Aula Magna'),
(171, 250, 'Giardino degli Studenti'),
(172, 10, 'Ufficio Tecnico'),
(173, 42, 'Aula Seminari'),
(174, 650, 'Polo Didattico Biotecnologie'),
(175, 107, 'Aula Laboratorio Fisica'),
(176, 7, 'Ufficio Placement'),
(177, 44, 'Aula Informatica 2'),
(178, 80, 'Aula Laboratorio Matematica'),
(179, 8, 'Ufficio Servizi Informatici'),
(180, 120, 'Giardino dei Saperi'),
(181, 59, 'Aula Studio B'),
(182, 5, 'Ufficio Didattico'),
(183, 98, 'Aula Conferenze'),
(184, 102, 'Aula Laboratorio Biologia')]

richiesta_evento = [(1, "Modifica", "Festival del Teatro Studentesco", 182, "Incontro di presentazione di nuove tecnologie", 33, "CRSDNL01C29G908C", "FRRRNN70T48G715L", None),
(2, "Modifica", "Conferenza Internazionale", 176, "Seminario avanzato per studenti magistrali", 43, "LMBMSM92P04B861X", "RMNDBR75S51A189M", None),
(3, "Modifica", "Workshop di Matematica", 127, "Attività seminariale di supporto alla didattica", 42, "DMCLCU91S70F205J", "TSTMNL84P12B861F", None),
(4, "Eliminazione", None, None, None, 33, None, "FRRRNN70T48G715L", None),
(5, "Modifica", "Evento di Innovazione Tecnologica", 174, "Evento di formazione continua", 40, "LRSSFN62L01C365K", "FBBLCA75B52A286A", None),
(6, "Eliminazione", None, None, None, 1, None, "ZNTDNC84L11B858F", None),
(7, "Inserimento", "Festival del Cinema Studentesco", 169, "Laboratorio interattivo a numero chiuso", None, "MZZMTT94C19B861V", None, 5),
(8, "Inserimento", "Workshop di Matematica", 117, "Evento formativo certificato", None, "DSNSRG96C16A189M", None, 10),
(9, "Inserimento", "Seminario di Storia dell'Arte", 116, "Evento aperto alla cittadinanza", None, "CNILGU97R15C792Y", None, 6),
(10, "Modifica", "Conferenza Internazionale", 143, "Evento di presentazione dei corsi di laurea", 35, "BSSNDR63C48C986R", "FSCLNE01A51C887J", None),
(11, "Eliminazione", None, None, None, 48, None, "LBRRRT97B04B207B", None),
(12, "Inserimento", "Torneo di Calcio Universitario", 147, "Incontro di presentazione di nuove tecnologie", None, "VLLDNL89E30F839G", None, "VRDPRZ04E41D111O"),
(13, "Modifica", "Torneo di Calcio Universitario", 32, "Attività seminariale di supporto alla didattica", 23, "BRBLRI58T61D111Z", "RNLVNC81S42F205Q", None),
(14, "Inserimento", "Torneo di E-Sports Universitario", 156, "Iniziativa di orientamento post-laurea", None, "PRSRCC56E69L045Y", None, "GRRGLI74E71A189I"),
(15, "Modifica", "Seminario di Letteratura Comparata", 158, "Laboratorio interattivo a numero chiuso", 1, "DNTTRS06S69A643J", "ZNTDNC84L11B858F", None),
(16, "Eliminazione", None, None, None, 36, None, "PRSGNN08R52D491D", None),
(17, "Eliminazione", None, None, None, 35, None, "FSCLNE01A51C887J", None),
(18, "Modifica", "Torneo di Sci Universitario", 78, "Seminario introduttivo per nuovi iscritti", 29, "CNIDNS80M17D433N", "RSSFNC60H25I123N", None),     
(19, "Modifica", "Laboratorio di Fisica Sperimentale", 186, "Giornata di sensibilizzazione e informazione", 7, "LNGDNL79H11H266B", "NPLDNL78R10C724W", None),
(20, "Inserimento", "Torneo di Pallavolo Universitario", 99, "Attività laboratoriale guidata", None, "CVLNGL82M52A037X", None, "DLCLRA95T45I143C")]


eventi=[(1, "Festival del Teatro Studentesco", "2026-05-10", "2026-05-11", 945, "Evento aperto alla cittadinanza", "ZNTDNC84L11B858F"),
(2, "Festival della Cultura", "2021-05-13", "2021-05-14", 8, "Evento formativo certificato", "BNCLRI99H45F883G"),
(3, "Workshop di Marketing Digitale", "2025-02-20", "2025-02-20", 1365, "Giornata informativa sui servizi universitari", "RSSCRL98S28C933M"),
(4, "Festival del Cinema Studentesco", "2021-06-09", "2021-06-09", 185, "Giornata informativa sui servizi universitari", "NNCMRC94M14A037S"),
(5, "Laboratorio di Chimica", "2022-08-01", "2022-08-01", 577, "Evento divulgativo per le scuole", "VRDDVD64L12C520H"),
(6, "Festival della Musica Universitaria", "2024-05-04", "2024-05-04", 62, "Workshop pratico con simulazioni reali", "MRCPTR72S20D969D"),
(7, "Torneo di Calcio Universitario", "2025-03-24", "2025-03-25", 51, "Presentazione di progetti di ricerca innovativi", "NPLDNL78R10C724W"),
(8, "Hackathon Informatica", "2023-12-26", "2023-12-26", 9, "Workshop intensivo di aggiornamento", "FRRVNC05S61F205M"),
(9, "Workshop di Statistica", "2020-12-08", "2020-12-08", 10, "Seminario su innovazione e sostenibilità", "DSNSRG96C16A189M"),
(10, "Laboratorio di Biologia Molecolare", "2024-01-12", "2024-01-12", 110, "Evento di disseminazione dei risultati di ricerca", "SLVJCP81D18H224Q"),
(11, "Torneo di Pallavolo Universitario", "2022-02-14", "2022-02-14", 47, "Tavola rotonda con professionisti del settore", "FRRLNE61M50A037S"),
(12, "Evento di Ricerca e Sviluppo", "2022-07-28", "2022-07-28", 42, "Workshop pratico per studenti universitari", "BNVPLA56B42C365I"),
(13, "Seminario di Storia dell'Arte", "2022-06-02", "2022-06-02", 3, "Convegno accademico annuale", "MSSGRL64R25A348D"),
(14, "Seminario di Filosofia", "2022-07-24", "2022-07-24", 51, "Seminario su innovazione e sostenibilità", "LMBMSM92P04B861X"),
(15, "Conferenza di Psicologia", "2024-07-23", "2024-07-23", 120, "Evento di formazione continua", "TSCDNL06E23A348K"),
(16, "Giornata dell'Orientamento", "2026-03-25", "2026-03-25", 1412, "Conferenza su tematiche di attualità", "SNTNNA07B49L424U"),
(17, "Giornata della Creatività", "2022-06-18", "2022-06-19", 103, "Evento istituzionale promosso dall’ateneo", "NREVLR76C04H703O"),
(18, "Evento di Ricerca e Sviluppo", "2023-07-25", "2023-07-26", 211, "Evento di presentazione dei corsi di laurea", "ZCCRNI79S64G715X"),
(19, "Workshop di Lingue Straniere", "2023-11-02", "2023-11-02", 109, "Convegno accademico annuale", "FSCNCL90L01C365C"),
(20, "Giornata della Creatività Digitale", "2025-11-08", "2025-11-08", 3, "Evento di disseminazione dei risultati di ricerca", "ZNTLXA08T04G224Y"),
(21, "Seminario di Storia dell'Arte", "2024-09-06", "2024-09-06", 53, "Iniziativa di orientamento post-laurea", "ZCCMRA90S51F839U"),
(22, "Seminario di Storia dell'Arte", "2023-03-26", "2023-03-26", 10, "Evento di orientamento per studenti e famiglie", "CRSDNL01C29G908C"),
(23, "Festival del Teatro Studentesco", "2022-02-07", "2022-02-07", 51, "Evento di orientamento per studenti e famiglie", "RNLVNC81S42F205Q"),
(24, "Giornata dell'Ingegneria", "2025-10-20", "2025-10-20", 5, "Incontro di presentazione di nuove tecnologie", "NPLDNL78R10C724W"),
(25, "Workshop di Statistica", "2026-03-24", "2026-03-24", 9, "Incontro di presentazione di nuove tecnologie", "VRDRCR64R09D433B"),
(26, "Festival del Teatro Studentesco", "2020-08-19", "2020-08-20", 87, "Evento aperto alla cittadinanza", "RSSCRS75C19A944H"),
(27, "Evento Culturale Interfacoltà", "2026-05-21", "2026-05-21", 5, "Incontro di divulgazione scientifica", "BNCLRI99H45F883G"),
(28, "Seminario di Economia Internazionale", "2021-11-06", "2021-11-06", 7, "Giornata di studio e confronto accademico", "MNTNCL89H70D276P"),
(29, "Evento di Beneficenza Studentesco", "2021-04-08", "2021-04-08", 108, "Evento di formazione continua", "RSSFNC60H25I123N"),
(30, "Workshop di Scrittura Accademica", "2023-10-25", "2023-10-25", 8, "Evento formativo certificato", "CRSDGI57H28A913F"),
(31, "Workshop di Matematica", "2020-08-31", "2020-08-31", 73, "Evento di formazione continua", "RMNCST61H60D433T"),
(32, "Workshop di Comunicazione Scientifica", "2025-10-27", "2025-10-29", 102, "Evento di networking tra studenti e aziende", "SRRDNC07M31H501V"),
(33, "Torneo di E-Sports Universitario", "2024-03-21", "2024-03-21", 1162, "Attività seminariale di supporto alla didattica", "FRRRNN70T48G715L"),
(34, "Giornata dell'Orientamento", "2020-12-17", "2020-12-17", 9, "Seminario di orientamento al lavoro", "FZADNC77B24D949G"),
(35, "Laboratorio di Biologia Molecolare", "2024-05-18", "2024-05-18", 211, "Evento istituzionale promosso dall’ateneo", "FSCLNE01A51C887J"),
(36, "Giornata della Creatività Digitale", "2022-12-03", "2022-12-05", 4, "Workshop pratico con simulazioni reali", "PRSGNN08R52D491D"),
(37, "Workshop di Lingue Straniere", "2020-07-09", "2020-07-09", 8, "Seminario introduttivo per nuovi iscritti", "VRDGRG06T30C986J"),
(38, "Giornata dello Studente Internazionale", "2020-12-28", "2020-12-28", 95, "Presentazione di progetti di ricerca innovativi", "NPLDNL78R10C724W"),
(39, "Workshop di Marketing Digitale", "2022-02-23", "2022-02-23", 5, "Incontro di presentazione di nuove tecnologie", "TSTNGL71S43L390M"),
(40, "Giornata delle Professioni Digitali", "2023-08-30", "2023-08-30", 99, "Conferenza con relatori internazionali", "FBBLCA75B52A286A"),
(41, "Evento di Beneficenza Studentesco", "2024-03-16", "2024-03-16", 9, "Giornata di studio e confronto accademico", "LRSSFN62L01C365K"),
(42, "Workshop di Marketing Digitale", "2023-02-02", "2023-02-02", 1365, "Seminario di orientamento al lavoro", "TSTMNL84P12B861F"),
(43, "Laboratorio di Informatica Avanzata", "2026-10-19", "2026-10-21", 719, "Evento di orientamento per studenti e famiglie", "RMNDBR75S51A189M"),
(44, "Saggio Teatrale Studentesco", "2025-06-17", "2025-06-17", 110, "Ciclo di incontri tematici interdisciplinari", "ZCCLSN99D52L219J"),
(45, "Laboratorio di Chimica Analitica", "2022-03-05", "2022-03-05", 9, "Seminario introduttivo per nuovi iscritti", "ZCCCLL58B61F205H"),
(46, "Workshop di Matematica", "2021-05-31", "2021-05-31", 96, "Incontro di approfondimento metodologico", "FRRNGL56T42H266K"),
(47, "Torneo di Calcio Universitario", "2024-07-16", "2024-07-16", 93, "Incontro formativo con esperti del settore", "FRRVNC05S61F205M"),
(48, "Conferenza di Psicologia", "2022-07-05", "2022-07-06", 325, "Giornata di studio e confronto accademico", "LBRRRT97B04B207B"),
(49, "Laboratorio di Biologia Molecolare", "2020-05-13", "2020-05-13", 102, "Conferenza divulgativa multidisciplinare", "CSTSLV06H65L219T"),
(50, "Giornata dell'Orientamento", "2020-06-22", "2020-06-22", 1139, "Incontro formativo con esperti del settore", "SLARTI80L65A643P")]

import random
from datetime import datetime, timedelta

# --- Funzioni utili ---
def random_datetime(start, end):
    delta = end - start
    seconds = random.randint(0, int(delta.total_seconds()))
    return start + timedelta(seconds=seconds)

def decide_change():
    r = random.random()
    if r < 0.4:
        return "orario"
    elif r < 0.7:
        return "luogo"
    else:
        return "entrambi"

def maybe_null(value):
    """Decide random se restituire NULL o il valore dato"""
    return None if random.random() < 0.3 else value

# --- Generazione INSERT ---
output_file = "insert_cambiare_orario.sql"
codice_counter = 1000

with open(output_file, "w") as f:  # uso 'w' per sovrascrivere file
    for re in richiesta_evento:
        codice_rich = re[0]
        tipo = re[1]
        
        # Inserimento sempre, modifica al 30%
        if tipo == "Inserimento" or (tipo == "Modifica" and random.random() < 0.3):
            change_type = decide_change()
            
            nuovo_inizio = None
            nuovo_fine = None
            codice_luogo = None
            
            # Trova evento corrispondente per le date
            evento = None
            for ev in eventi:
                if ev[0] == re[5]:  # codice_evento = re[5]
                    evento = ev
                    break
            
            # Se cambia orario o entrambi
            if change_type in ["orario", "entrambi"]:
                if evento and tipo == "Inserimento":
                    # Usa date evento come base
                    start_base = datetime.strptime(evento[2], "%Y-%m-%d")
                    end_base = datetime.strptime(evento[3], "%Y-%m-%d") + timedelta(hours=23, minutes=59)
                else:
                    # Caso modifica senza evento: date random
                    start_base = datetime(2026, 2, 1, 8, 0, 0)
                    end_base = datetime(2026, 2, 28, 18, 0, 0)
                
                nuovo_inizio = maybe_null(random_datetime(start_base, end_base))
                if nuovo_inizio:
                    nuovo_fine = maybe_null(nuovo_inizio + timedelta(hours=random.choice([1,2,3])))
                else:
                    nuovo_fine = maybe_null(random_datetime(start_base, end_base))
            
            # Se cambia luogo o entrambi
            if change_type in ["luogo", "entrambi"]:
                codice_luogo = maybe_null(random.choice(luoghi)[0])
            
            # Conversione per SQL
            nuovo_inizio_str = f"'{nuovo_inizio.strftime('%Y-%m-%d %H:%M:%S')}'" if nuovo_inizio else "NULL"
            nuovo_fine_str = f"'{nuovo_fine.strftime('%Y-%m-%d %H:%M:%S')}'" if nuovo_fine else "NULL"
            codice_luogo_str = str(codice_luogo) if codice_luogo is not None else "NULL"
            
            # Scrive INSERT
            f.write(
                f"insert into Cambiare_Orario values "
                f"({codice_counter}, {codice_rich}, {nuovo_inizio_str}, {nuovo_fine_str}, {codice_luogo_str});\n"
            )
            codice_counter += 1

print(f"INSERT generati e salvati in {output_file}")

